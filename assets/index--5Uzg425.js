var y=Object.defineProperty;var E=h=>{throw TypeError(h)};var b=(h,t,i)=>t in h?y(h,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):h[t]=i;var o=(h,t,i)=>b(h,typeof t!="symbol"?t+"":t,i),U=(h,t,i)=>t.has(h)||E("Cannot "+i);var w=(h,t,i)=>t.has(h)?E("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(h):t.set(h,i);var I=(h,t,i)=>(U(h,t,"access private method"),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function i(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(e){if(e.ep)return;e.ep=!0;const s=i(e);fetch(e.href,s)}})();class H{constructor(t,i){o(this,"width");o(this,"height");o(this,"data");this.width=t,this.height=i,this.data=[];for(let a=0;a<this.height;a++){const e=[];for(let s=0;s<this.width;s++)e.push(+(Math.random()<.5));this.data.push(e)}}}class f{constructor(t){o(this,"canvas");o(this,"ctx");o(this,"width");o(this,"height");this.canvas=t,this.width=this.canvas.width,this.height=this.canvas.height;const i=this.canvas.getContext("2d");i&&(this.ctx=i)}drawImage(t){return new Promise((i,a)=>{const e=new Image;e.src=t,e.onload=()=>{var s;if(e.width!=this.width||e.height!=this.height){a(`Wrong image dimensions! Should be ${this.width}x${this.height}.`);return}(s=this.ctx)==null||s.drawImage(e,0,0),i()}})}}class N{constructor(t){o(this,"width");o(this,"height");o(this,"data");if(this.width=t.width,this.height=t.height,this.data=[],!t.ctx)return;const a=t.ctx.getImageData(0,0,this.width,this.height).data;for(let e=0;e<this.height;e++){const s=[];for(let n=0;n<this.width;n++){const A=(e*this.width+n)*4,v=a[A],R=a[A+1],x=a[A+2],M=(v+R+x)/3/255;s.push(M)}this.data.push(s)}}}var d,S;class k{constructor(t,i,a=20,e=!0){w(this,d);o(this,"baseNoise");o(this,"heightMap");o(this,"depth");o(this,"width");o(this,"height");o(this,"data");o(this,"crossView");this.baseNoise=t,this.heightMap=i,this.check_noise_height_dimensions(),this.width=t.width*2,this.height=t.height,this.depth=a,this.crossView=e,this.data=[],I(this,d,S).call(this)}check_noise_height_dimensions(){if(this.baseNoise.width!=this.heightMap.width||this.baseNoise.height!=this.heightMap.height)throw Error("height map and noise don't have the same dimensions")}draw(t){t.clearRect(0,0,this.width,this.height);var i=t.getImageData(0,0,this.width,this.height),a=i.data;for(let e=0;e<this.height;e++)for(let s=0;s<this.width;s++){const n=(e*this.width+s)*4,A=this.data[e][s];a[n]=A*255,a[n+1]=A*255,a[n+2]=A*255,a[n+3]=255}t.putImageData(i,0,0)}}d=new WeakSet,S=function(){this.data=JSON.parse(JSON.stringify(this.baseNoise.data));for(let t=0;t<this.height;t++)this.data[t].push(...this.baseNoise.data[t]);for(let t=0;t<this.height;t++)for(let i=0;i<this.width/2;i++){const a=this.heightMap.data[t][i],e=this.baseNoise.data[t][i],s=Math.round(a*this.depth);let n;this.crossView?n=Math.min(Math.max(0,i-s),this.baseNoise.width):n=Math.min(Math.max(0,i+s),this.baseNoise.width),this.data[t][n]=e}};const m="data:image/png;base64,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",L="/assets/cat_heightmap-BQ9PdAsQ.png",O="/assets/cone_heightmap-BMakZVHt.png",J="/assets/spiral_heightmap-BCYD9xeS.png",F="/assets/cellnoise_heightmap-jRciHM7C.png",X=[{name:"Ring",src:m},{name:"Spiral",src:J},{name:"Cone",src:O},{name:"Cat",src:L},{name:"Noise",src:F}];var c,l,Q,C,p=20,r=!0;const Y=(h,t)=>{const i=document.createElement("div");i.className="alert";const a=document.createElement("span");a.textContent=t;const e=document.createElement("span");e.className="closeButton",e.textContent="âœ•",e.onclick=s=>{var n;(n=s.target.parentElement)==null||n.remove()},i.appendChild(a),i.appendChild(e),h.appendChild(i)},K=()=>{const h=document.getElementById("stereogram");c=new f(h);const t=document.getElementById("height");l=new f(t)},u=h=>{const t=h??m;l.drawImage(t).then(()=>{Q=new N(l),g()}).catch(i=>{const a=document.getElementById("heightMapContainer");Y(a,i)})},g=()=>{const h=new H(c.width/2,c.height);C=new k(h,Q,p,r),c.ctx&&C.draw(c.ctx)},V=()=>{const h=document.getElementById("generate");h.onclick=g;const t=document.getElementById("heightSelect");t.onchange=Z,X.forEach(n=>{const A=document.createElement("option");A.value=n.src,A.textContent=n.name,t.appendChild(A)}),t.value=m;const i=document.getElementById("heightInput");i.onchange=T;const a=document.getElementById("depthInput");a.value=String(p),a.onchange=D;const e=document.getElementById("crossEyeRadio"),s=document.getElementById("parallelRadio");e.checked=r,s.checked=!r,e.onchange=()=>B(!0),s.onchange=()=>B(!1)},B=h=>{r=h,g()},Z=h=>{const t=h.target;u(t.value)},T=h=>{const t=h.target;if(!t.files)return;const a=(window.URL||window.webkitURL).createObjectURL(t.files[0]);u(a);const e=document.getElementById("heightSelect"),s=document.createElement("option");s.value=a,s.textContent=t.files[0].name,e.appendChild(s),e.value=a},D=h=>{const t=h.target;p=Number(t.value),g()};V();K();u();
